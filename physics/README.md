# physics/ - 物理計算

PSAプロセスの物理現象を計算する中核モジュール。

## ファイル一覧

| ファイル | 説明 |
|---------|------|
| `mass_balance.py` | 物質収支計算（吸着/脱着量） |
| `heat_balance.py` | 熱収支計算（温度変化） |
| `heat_transfer.py` | 熱伝達係数計算（Yagi-Kuniiモデル） |
| `pressure.py` | 純粋な圧力計算（真空脱着後・バッチ後） |
| `vacuum_pumping.py` | 真空排気計算（CO2回収量含む） |
| `equalization.py` | 均圧計算（塔間ガス移動） |
| `adsorption_isotherm.py` | 吸着平衡線（平衡吸着量計算） |

## 各モジュールの役割

### mass_balance.py - 物質収支
- 吸着モード：CO2が吸着材に吸着される量を計算
- 脱着モード：真空引きでCO2が脱着される量を計算
- LDFモデル（Linear Driving Force）による吸着速度計算

### heat_balance.py - 熱収支
- 充填層の熱収支：吸着熱 + ガス流入熱 + 隣接セルとの熱交換
- 壁面の熱収支：充填層からの熱流入、外気への放熱
- 蓋の熱収支：充填層・壁からの熱流入

### heat_transfer.py - 熱伝達係数
- Yagi-Kuniiモデルによる有効熱伝導率計算
- 壁-層間、層内の伝熱係数

### pressure.py - 純粋な圧力計算
- 真空脱着後の圧力（気相放出後の圧力）
- バッチ吸着後の圧力変化

### vacuum_pumping.py - 真空排気計算
- 真空ポンプによる排気量計算
- 配管の圧力損失（反復法）
- CO2/N2回収量の計算

### equalization.py - 均圧計算
- 均圧減圧時の流量と圧力変化
- 下流塔への流入量計算
- 配管の圧力損失（反復法）

### adsorption_isotherm.py - 吸着平衡線
- 温度・圧力から平衡吸着量を計算
- シンボリック回帰による近似式を使用

## 計算の流れ（各タイムステップ）

```
1. 物質収支計算 → CO2/N2の吸着・脱着量を算出
2. 熱収支計算   → 吸着熱等から温度変化を算出
3. 圧力計算     → 全圧を更新
```
