# physics/ - 物理計算

PSAプロセスの物理現象を計算する中核モジュール。

## 設計方針

- 各モジュールは**単一の物理量/物理式**を計算する
- **モード固有のオーケストレーション**は`operation_modes/`で行う
- **状態に依存しない純粋な関数**として実装

## ファイル一覧

| ファイル | 説明 |
|---------|------|
| `mass_balance.py` | 物質収支計算（吸着/脱着量） |
| `heat_balance.py` | 熱収支計算（温度変化） |
| `heat_transfer.py` | 熱伝達係数計算（Yagi-Kuniiモデル） |
| `pressure.py` | 圧力計算（状態方程式ベース） |
| `gas_properties.py` | ガス物性計算（粘度・密度） |
| `pipe_flow.py` | 配管流量・圧力損失計算 |
| `recovery.py` | 回収量計算（脱着量） |
| `adsorption_isotherm.py` | 吸着平衡線（平衡吸着量計算） |

## 各モジュールの役割

### mass_balance.py - 物質収支
- 吸着モード：CO2が吸着材に吸着される量を計算
- 脱着モード：真空引きでCO2が脱着される量を計算
- LDFモデル（Linear Driving Force）による吸着速度計算

### heat_balance.py - 熱収支
- 充填層の熱収支：吸着熱 + ガス流入熱 + 隣接セルとの熱交換
- 壁面の熱収支：充填層からの熱流入、外気への放熱
- 蓋の熱収支：充填層・壁からの熱流入

### heat_transfer.py - 熱伝達係数
- Yagi-Kuniiモデルによる有効熱伝導率計算
- 壁-層間、層内の伝熱係数

### pressure.py - 圧力計算
- 真空脱着後の圧力（気相放出後の圧力）
- バッチ吸着後の圧力変化
- ヘルパー関数：平均温度・平均モル分率の計算

### gas_properties.py - ガス物性計算
- CO2/N2混合ガスの粘度計算
- CO2/N2混合ガスの密度計算
- CoolPropを使用した物性取得

### pipe_flow.py - 配管流量・圧力損失計算
- 真空ポンプの排気速度と圧力損失（反復法）
- 均圧配管の流量と圧力損失（反復法）
- 理想気体の状態方程式に基づく圧力変化

### recovery.py - 回収量計算
- 脱着によるCO2回収量計算
- N2回収量（気相組成から推算）
- CO2回収濃度の計算

### adsorption_isotherm.py - 吸着平衡線
- 温度・圧力から平衡吸着量を計算
- シンボリック回帰による近似式を使用

## 計算の流れ（各タイムステップ）

```
1. 物質収支計算 → CO2/N2の吸着・脱着量を算出
2. 熱収支計算   → 吸着熱等から温度変化を算出
3. 圧力計算     → 全圧を更新
```
